suppressPackageStartupMessages({
library(dplyr)
library(tibble)
library(tidyr)
library(stringr)
library(ggplot2)
library(grid)
library(gridExtra)
library(data.table)
library(rearrr)
library(reticulate)
library(anndata)
})
options(stringsAsFactors = FALSE)
options(scipen=9999)
options(mc.cores=20)
# read in old segmentation
vpt <- read_h5ad("/data/VPT_processed_data/mouse_638850_processed_VPT.h5ad")
metadata_vpt <- vpt$obs
colnames(vpt_metadata)
colnames(metadata_vpt)
View(metadata_vpt)
vpt
sort(colnames(metadata_vpt))
# read in new segmentation
sis <- read_h5ad("/data/SIS_processed_data/mouse_638850_processed_SIS.h5ad")
metadata_sis <- sis$obs
# set of sections
section_set <- c("1199650950","1199650944","1199650938","1199651036","1199651048")
example_vpt <- metadata_vpt %>%
filter(section %in% section_set)
# plot sections
ggplot(example_vpt,
aes(x=corrected_x,
y=corrected_y,
)) +
geom_point(size=point_size,stroke=0,shape=19, color = "grey") +
coord_fixed() +
ggtitle("CCF registration") +
scale_color_manual(values=CCF_regions_color) +
scale_y_reverse() +
theme(legend.position = "none") +
guides(color = "none") +
facet_wrap(~section)
# plot sections
ggplot(example_vpt,
aes(x=corrected_x,
y=corrected_y,
)) +
geom_point(size=1,stroke=0,shape=19, color = "grey") +
coord_fixed() +
ggtitle("CCF registration") +
scale_color_manual(values=CCF_regions_color) +
scale_y_reverse() +
theme(legend.position = "none") +
guides(color = "none") +
facet_wrap(~section)
# plot sections
ggplot(example_vpt,
aes(x=corrected_x,
y=corrected_y,
)) +
geom_point(size=1,stroke=0,shape=19, color = "grey") +
coord_fixed() +
ggtitle("CCF registration") +
#scale_color_manual(values=CCF_regions_color) +
scale_y_reverse() +
theme(legend.position = "none") +
guides(color = "none") +
facet_wrap(~section) +
theme_void()
# plot sections
ggplot(example_vpt,
aes(x=corrected_x,
y=corrected_y,
)) +
geom_point(size=.1,stroke=0,shape=19, color = "grey") +
coord_fixed() +
ggtitle("VPT Segmentation") +
#scale_color_manual(values=CCF_regions_color) +
scale_y_reverse() +
theme(legend.position = "none") +
guides(color = "none") +
facet_wrap(~section, nrow = 1) +
theme_void()
# plot sections
ggplot(example_sis,
aes(x=corrected_x,
y=corrected_y,
)) +
geom_point(size=.1,stroke=0,shape=19, color = "grey") +
coord_fixed() +
ggtitle("SIS Segmentation") +
#scale_color_manual(values=CCF_regions_color) +
scale_y_reverse() +
theme(legend.position = "none") +
guides(color = "none") +
facet_wrap(~section, nrow = 1) +
theme_void()
example_sis <- metadata_sis %>%
filter(section %in% section_set)
# plot sections
ggplot(example_sis,
aes(x=corrected_x,
y=corrected_y,
)) +
geom_point(size=.1,stroke=0,shape=19, color = "grey") +
coord_fixed() +
ggtitle("SIS Segmentation") +
#scale_color_manual(values=CCF_regions_color) +
scale_y_reverse() +
theme(legend.position = "none") +
guides(color = "none") +
facet_wrap(~section, nrow = 1) +
theme_void()
colnames(metadata_sis)
sis
coordinates_sis <- sis$obsm$spatial
rownames(coordinates_sis) <- rownames(sis$X)
rownames(metadata_sis)
View(example_sis)
rownames(sis$X)
View(metadata_sis)
coordinates_sis$index <- sis$obs$index
coordinates_sis <- as.data.frame(coordinates_sis)
coordinates_sis <- as.matrix(sis$obsm$spatial)
coordinates_sis <- as.data.frame(coordinates_sis)
coordinates_sis$index <- sis$obs$index
cooedinates_sis$section <- sis$obs$section
coordinates_sis$section <- sis$obs$section
example_sis <-coordinates_sis %>%
filter(section %in% section_set)
View(coordinates_sis)
coordinates_sis <- as.matrix(sis$obsm$spatial)
coordinates_sis <- as.data.frame(coordinates_sis)
colnames(coordinates_sis) <- c("x_coordinate","y_coordinate")
coordinates_sis$index <- sis$obs$index
coordinates_sis$section <- sis$obs$section
coordinates_sis <- as.matrix(sis$obsm$spatial)
coordinates_sis <- as.data.frame(coordinates_sis)
colnames(coordinates_sis) <- c("x_coordinate","y_coordinate")
coordinates_sis$section <- sis$obs$section
example_sis <-coordinates_sis %>%
filter(section %in% section_set)
# plot sections
ggplot(example_sis,
aes(x=x_coordinate,
y=y_coordinate,
)) +
geom_point(size=.1,stroke=0,shape=19, color = "grey") +
coord_fixed() +
ggtitle("SIS Segmentation") +
#scale_color_manual(values=CCF_regions_color) +
scale_y_reverse() +
theme(legend.position = "none") +
guides(color = "none") +
facet_wrap(~section, nrow = 1) +
theme_void()
sis
coordinates_sis <- as.matrix(sis$obsm$spatial_centered)
coordinates_sis <- as.data.frame(coordinates_sis)
colnames(coordinates_sis) <- c("x_coordinate","y_coordinate")
coordinates_sis$section <- sis$obs$section
example_sis <-coordinates_sis %>%
filter(section %in% section_set)
# plot sections
ggplot(example_sis,
aes(x=x_coordinate,
y=y_coordinate,
)) +
geom_point(size=.1,stroke=0,shape=19, color = "grey") +
coord_fixed() +
ggtitle("SIS Segmentation") +
#scale_color_manual(values=CCF_regions_color) +
scale_y_reverse() +
theme(legend.position = "none") +
guides(color = "none") +
facet_wrap(~section, nrow = 1) +
theme_void()
coordinates_sis <- as.matrix(sis$obsm$spatial_rotate)
coordinates_sis <- as.data.frame(coordinates_sis)
colnames(coordinates_sis) <- c("x_coordinate","y_coordinate")
coordinates_sis$section <- sis$obs$section
example_sis <-coordinates_sis %>%
filter(section %in% section_set)
# plot sections
ggplot(example_sis,
aes(x=x_coordinate,
y=y_coordinate,
)) +
geom_point(size=.1,stroke=0,shape=19, color = "grey") +
coord_fixed() +
ggtitle("SIS Segmentation") +
#scale_color_manual(values=CCF_regions_color) +
scale_y_reverse() +
theme(legend.position = "none") +
guides(color = "none") +
facet_wrap(~section, nrow = 1) +
theme_void()
# plot sections
plot1 <- ggplot(example_vpt,
aes(x=corrected_x,
y=corrected_y,
)) +
geom_point(size=.1,stroke=0,shape=19, color = "grey") +
coord_fixed() +
ggtitle("VPT Segmentation") +
#scale_color_manual(values=CCF_regions_color) +
scale_y_reverse() +
theme(legend.position = "none") +
guides(color = "none") +
facet_wrap(~section, nrow = 1) +
theme_void()
# plot sections
plot2 <- ggplot(example_sis,
aes(x=x_coordinate,
y=y_coordinate,
)) +
geom_point(size=.1,stroke=0,shape=19, color = "grey") +
coord_fixed() +
ggtitle("SIS Segmentation") +
#scale_color_manual(values=CCF_regions_color) +
scale_y_reverse() +
theme(legend.position = "none") +
guides(color = "none") +
facet_wrap(~section, nrow = 1) +
theme_void()
combined_plot <- plot_grid(plot1, plot2, nrow = 2)
combined_plot
library(cowplot)
combined_plot <- plot_grid(plot1, plot2, nrow = 2)
combined_plot
ggsave(filename = "/results/example_sections.pdf",
plot = combined_plot,
width = 10,
height = 4,
dpi = 300)
ggsave(filename = "/results/example_sections.pdf",
plot = combined_plot,
width = 10,
height = 4,
dpi = 160)
ggsave(filename = "/results/example_sections.png",
plot = combined_plot,
width = 10,
height = 4,
dpi = 160)
ggsave(filename = "/results/example_sections.pdf",
plot = combined_plot,
width = 5,
height = 2,
dpi = 160)
ggsave(filename = "/results/example_sections.pdf",
plot = combined_plot,
width = 10,
height = 4,
dpi = 160)
suppressPackageStartupMessages({
library(dplyr)
library(tibble)
library(tidyr)
library(cowplot)
library(stringr)
library(ggplot2)
library(grid)
library(gridExtra)
library(data.table)
library(rearrr)
library(reticulate)
library(anndata)
})
options(stringsAsFactors = FALSE)
options(scipen=9999)
options(mc.cores=20)
# read in old segmentation
vpt <- read_h5ad("/data/VPT_processed_data/mouse_638850_processed_VPT.h5ad")
# read in old segmentation
vpt <- read_h5ad("/data/VPT_processed_data/mouse_638850_processed_VPT.h5ad")
nometadata_vpt <- vpt$obs
final_vpt <- metadata_vpt %>%
filter(final_filter == FALSE) %>%
select(volume,
n_genes_by_counts,
total_counts,
total_counts_per_cell_volume)
suppressPackageStartupMessages({
library(dplyr)
library(tibble)
library(tidyr)
library(cowplot)
library(stringr)
library(ggplot2)
library(grid)
library(gridExtra)
library(data.table)
library(rearrr)
library(reticulate)
library(anndata)
})
options(stringsAsFactors = FALSE)
options(scipen=9999)
options(mc.cores=20)
# read in old segmentation
vpt <- read_h5ad("/data/VPT_processed_data/mouse_638850_processed_VPT.h5ad")
