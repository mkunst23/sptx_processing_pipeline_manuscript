labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[50]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[51]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[52]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[53]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[54]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[55]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[56]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[57]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[58]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[59]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[60]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[61]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[62]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[63]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[64]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[65]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[66]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[67]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[68]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
subclass_name <- cluster_names[69]
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name == subclass_name)
ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
plot <- ggplot(vol_comp_1,
aes(x = flat_CDM_supertype_name,
y = volume,
fill = flat_CDM_supertype_name)) +
geom_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F) +
#coord_trans(y = "log10") +
ggtitle(subclass_name) +
scale_fill_manual(values=supertype_color_palette) +
facet_wrap(~tool) +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
fixed_name <-  gsub("/", "-", subclass_name)
# look at volume distribution
ggsave(filename = paste0("/results/volume_",fixed_name,".pdf"),
plot = plot,
width = 12,
height = 7,
dpi = 300)
# subset dataset to two subclasses
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name %in% c("046 Vip Gaba","022 L5 ET CTX Glut"))
plot1 <- ggplot(vol_comp_1,
aes(x = tool,
y = volume,
fill = flat_CDM_subclass_name)) +
geom_split_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F,
position = position_dodge(.2)) +
#coord_trans(y = "log10") +
scale_fill_brewer(palette = "Dark2", name = "Subclass") +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name %in% c("046 Vip Gaba","058 PAL-STR Gaba-Chol"))
plot2 <- ggplot(vol_comp_1,
aes(x = tool,
y = volume,
fill = flat_CDM_subclass_name)) +
geom_split_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F,
position = position_dodge(.2)) +
#coord_trans(y = "log10") +
scale_fill_brewer(palette = "Dark2", name = "Subclass") +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
vol_comp_1 <- combined_meta %>%
filter(flat_CDM_subclass_name %in% c("046 Vip Gaba","215 SNc-VTA-RAmb Foxa1 Dopa"))
plot3 <- ggplot(vol_comp_1,
aes(x = tool,
y = volume,
fill = flat_CDM_subclass_name)) +
geom_split_violin(alpha = .4) +
geom_boxplot(width = .2,
alpha = .6,
fatten = NULL,
show.legend = F) +
stat_summary(fun = "median",
show.legend = F,
position = position_dodge(.2)) +
#coord_trans(y = "log10") +
scale_fill_brewer(palette = "Dark2", name = "Subclass") +
labs(x = "", y = "cell volume") + # Customize axis labels
theme_minimal() + # Remove x-axis elements
theme(axis.text.x = element_text(angle = 45, hjust = 1))
combined_plots <- plot_grid(plot1, plot2, plot3, nrow = 1)
ggsave(filename = "/results/small_vs_large_1_qc.pdf",
plot = combined_plots,
width = 12,
height = 7,
dpi = 300)
